extends layout

block content
  script(src='/bower_components/c3/c3.min.js')
  script(src='/bower_components/d3/d3.min.js')
  script(src='/bower_components/matchHeight/dist/jquery.matchHeight-min.js')

  .layout-pf.layout-pf-fixed
    nav(class='navbar navbar-pf', role='navigation')
      .navbar-header
        button(type='button' class='navbar-toggle' data-target='navbar-collapse-1')
          span.sr-only Toggle navigation
          span.icon-bar
          span.icon-bar
          span.icon-bar
        a(href='/', class='navbar-brand')
          //img(class='navbar-brand-icon', src='/bower_components/patternfly/dist/img/logo-alt.svg', alt='')
          img(class='navbar-brand-name', alt='AWS S3 Image Viewer')
      .collapse.navbar-collapse.navbar-collapse-1
        ul.nav.navbar-nav.navbar-right.navbar-utility
          li.dropdown
            a(href='#0', class='dropdown-toggle nav-item-iconic' id='dropdownMenu1' data-toggle='dropdown' aria-haspopup='true' aria-expanded='true')
              span(title='Help', class='fa pficon-help')
              span(class='caret')
            ul(class='dropdown-menu', aria-labelledby='dropdownMenu1')
              li: a(href='/about') About
        ul.nav.navbar-nav.navbar-primary
          - var bucketsArray = JSON.parse(buckets);
          if bucketsArray.length < 1
            .toast-pf.toast-pf-top-right.alert-warning.alert-dismissable.alert
              button(type='button' class='close' data-dismiss='alert' aria-hidden='true')
                span.pficon.pficon-close
              span.pficon.pficon-warning-triangle-o
              | No buckets have been configured
            li
              a(href='#0')
                span(class='pficon pficon-warning-triangle-o' data-toggle='tooltip' title='NONE')
                span(class='list-group-item-value') #[em   NO BUCKETS]
          else
            each bucketIter in bucketsArray ? bucketsArray: ['No Buckets!']
              li
                a(href='/?showBucket='+ bucketIter)
                  span(class='fa fa-bitbucket' data-toggle='tooltip' title=bucketIter)
                  span(class='list-group-item-value') #[  #{bucketIter}]

  .container-fluid.container-cards-pf
    br
    p Welcome to #{title} - you are viewing S3 bucket #[strong #{showBucket}]
    - var imagesArray = JSON.parse(images);
    if imagesArray.length < 1
      .blank-slate-pf
        .blank-slate-pf-icon
          .fa.fa-ban
          p #[strong No Images Found]
    else
      .row.row-cards-pf
      each imageUrl in imagesArray ? imagesArray: ['DANGER-WILL-ROBINSON']
        //.col-xs-12.col-sm-6.col-md-4.col-lg-3
        .col-xs-12.col-sm-4.col-md-3.col-lg-2
          .card-pf.card-pf-view
            .card-pf-body
              .card-pf-top-element
                  img(src=imageUrl, alt='Image', style='max-height: 100%; width: 100%; object-fit: contain')
              //.card-pf-title.text-center #{imageUrl}
              .card-pf-items.text-center
                a(href=imageUrl)
                  span.fa.fa-arrow-circle-o-down.fa-2x
    
  script(type='text/javascript').
    $(document).ready(function() {
      // matchHeight the contents of each .card-pf and then the .card-pf itself
      $(".row-cards-pf > [class*='col'] > .card-pf .card-pf-title").matchHeight();
      $(".row-cards-pf > [class*='col'] > .card-pf > .card-pf-body").matchHeight();
      $(".row-cards-pf > [class*='col'] > .card-pf > .card-pf-footer").matchHeight();
      $(".row-cards-pf > [class*='col'] > .card-pf").matchHeight();

      // initialize tooltips
      $('[data-toggle="tooltip"]').tooltip();

      // Initialize the vertical navigation
      $().setupVerticalNavigation(true);
    });